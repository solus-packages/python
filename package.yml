name       : python
version    : 2.7.15
release    : 22
source     :
    - https://www.python.org/ftp/python/2.7.15/Python-2.7.15.tar.xz : 22d9b1ac5b26135ad2b8c2901a9413537e08749a753356ee913c84dbd2df5574
license    :
    - Python-2.0
summary    :
    - Python 2.7
    - test : Python 2.7 Test package
    - tkinter : Python 2.7 TKinter package
component  :
    - system.base
    - test : programming.python
    - tkinter : programming.python
builddeps  :
    - pkgconfig(expat)
    - pkgconfig(libffi)
    - pkgconfig(sqlite3)
    - pkgconfig(tcl)
    - pkgconfig(tk)
    - pkgconfig(x11)
    - bzip2-devel
    - db5-devel
    - gdbm-devel
devel      : yes
autodep    : no
rundeps    :
    - test : python
    - tkinter :
        - tk
        - tcl
patterns   :
    - /usr/include/python2.7/pyconfig.h
    - test :
        - /usr/lib/python2.7/test
    - tkinter :
        - /usr/lib/python2.7/lib-dynload/_tkinter.so
optimize   :
    - speed
description: |
    An interactive high-level object-oriented language (version 2.7) Version 2.7 of the high-level, interactive object oriented language, includes an extensive class library with lots of goodies for network programming, system administration, sounds and graphics.
setup      : |
    %patch -p1 < $pkgfiles/security/cve-2018-14647.patch
    %patch -p1 < $pkgfiles/security/cve-2018-1000802.patch

    # Enforce gdbm usage
    sed -e "s/ndbm_libs =.*/ndbm_libs = ['gdbm', 'gdbm_compat']/g" -i setup.py
    # Fix db5
    %patch -p1 < $pkgfiles/Python-2.7.1-berkeley-db-5.3-2.patch

    autoreconf -vfi

    # Preserve compat with old Python package in Solus by forcing lib, not lib64
    %configure --prefix=/usr \
               --enable-unicode=ucs4 \
               --with-system-expat \
               --with-system-ffi \
               --with-threads \
               --enable-shared \
               --libdir=/usr/lib \
               CFLAGS="$CFLAGS -I/usr/include"
build      : |
    %make profile-opt
install    : |
    %make_install
